# 微信机器人故障排除指南

## 常见错误及解决方案

### 1. KeyError: '37c6bee7fca16925572addb7c1b5ba55'

**错误描述**: 这是 wxauto 库内部的消息ID管理错误，通常发生在微信界面状态变化时。

**可能原因**:
- 微信窗口被最小化或失去焦点
- 微信聊天界面切换
- 系统资源不足导致的延迟
- wxauto 库内部状态不一致

**解决方案**:
1. **保持微信窗口活跃**: 确保微信窗口处于可见状态，不要最小化
2. **避免手动操作**: 程序运行时尽量不要手动点击微信界面
3. **重启程序**: 如果错误持续出现，重启机器人程序
4. **重启微信**: 必要时重启微信客户端

**代码改进**:
新版本已增加了对此错误的处理：
- 自动捕获 KeyError 并跳过当次检查
- 连续错误计数和自动恢复机制
- 更详细的错误日志

### 2. 程序突然停止响应

**可能原因**:
- 网络连接问题
- API 调用超时
- 微信客户端异常

**解决方案**:
1. 检查网络连接
2. 验证 API 密钥是否正确
3. 重启程序和微信

### 3. 发送消息失败

**可能原因**:
- 聊天窗口未正确定位
- 微信账号被限制
- 网络延迟

**解决方案**:
1. 确保目标聊天窗口存在
2. 检查微信账号状态
3. 增加发送间隔时间

## 最佳实践

### 运行环境
1. **保持微信窗口可见**: 不要最小化微信窗口
2. **稳定的网络环境**: 确保网络连接稳定
3. **充足的系统资源**: 避免系统资源不足

### 程序配置
1. **合理的检查间隔**: 默认0.5秒间隔通常足够
2. **API密钥管理**: 确保所有API密钥正确配置
3. **日志监控**: 关注程序输出的错误信息

### 错误恢复
1. **自动重试**: 程序会自动处理临时错误
2. **手动重启**: 连续错误时建议手动重启
3. **环境检查**: 定期检查微信和网络状态

## 调试技巧

### 开启调试模式
```bash
python MyRepeaterNew_AgentDouble.py --debug
```

### 查看详细日志
程序会输出详细的执行日志，包括：
- 消息接收情况
- 工具使用情况
- 错误详细信息
- 发送结果反馈

### 测试连接
可以通过以下方式测试各组件：
1. 发送简单消息测试微信连接
2. 询问知识库相关问题测试RAG功能
3. 询问实时信息测试联网搜索

## 联系支持

如果问题持续存在，请：
1. 记录完整的错误日志
2. 描述操作步骤和环境信息
3. 检查是否为已知问题